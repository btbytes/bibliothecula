<!-- Hello. see /doc.txt for explanations on the used CSS/HTML5 techniques
  without javascript. -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>bibliothecula</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta property="og:type" content="website">
  <meta property="og:image" content="https://nessuent.xyz/bibliothecula.png">
  <meta property="og:site_name" content="bibliothecula - tagged document storage">
  <meta property="og:title" content="bibliothecula - tagged document storage">
  <link rel="stylesheet" media="all" href="./css/style.css" />
</head>
<body class="index">
  <figure id="grid-zoom" class="zoom">
    <a class="zoom" href="#web-gui"><img width="1908" height="982" src='./img/screenshot-grid-view.webp' alt="grid view" decoding="async" loading="lazy"></a>
    <figcaption> grid view (<em>click to close</em>) </figcaption>
  </figure>
  <figure id="full-text-grid-zoom" class="zoom">
    <a class="zoom" href="#web-gui"><img width="808"  height="1006"  src='./img/screenshot-full-text-grid-property.webp' alt="full-text search on grid view" decoding="async" loading="lazy"></a>
    <figcaption> full-text search on grid view (<em>click to close</em>) </figcaption>
  </figure>
  <figure id="full-text-table-zoom" class="zoom">
    <a class="zoom" href="#web-gui"><img width="1908"  height="1010"  src='./img/screenshot-full-text-table-property.webp' alt="and on table view" decoding="async" loading="lazy"></a>
    <figcaption> and on table view (<em>click to close</em>) </figcaption>
  </figure>
  <figure id="database-zoom" class="zoom">
    <a class="zoom" href="#web-gui"><img width="1908"  height="5765"  src='./img/screenshot-database-view.webp' alt="database view" decoding="async" loading="lazy"></a>
    <figcaption> database view (<em>click to close</em>) </figcaption>
  </figure>
  <figure id="d3-zoom" class="zoom">
    <a class="zoom" href="#web-gui"><img width="1908" height="1384" src='./img/screenshot-d3-tag-graph.webp' alt="d3.js tag visualization" decoding="async" loading="lazy"></a>
    <figcaption>
      <a href="https://bl.ocks.org/heybignick/3faf257bbbbc7743bb72310d03b86ee8" rel="external nofollow"><code>d3.js</code></a> tag visualization (<em>click to close</em>)
    </figcaption>
  </figure>
  <figure id="document-zoom" class="zoom">
    <a class="zoom" href="#web-gui"><img width="1631" height="539" src='./img/screenshot-document-view.webp' alt="document view" decoding="async" loading="lazy"></a>
    <figcaption> document view (<em>click to close</em>) </figcaption>
  </figure>
  <header>
    <h1 class="hover" title="the colorscheme of the page is inspired by the cover of the first edition of Dracula by Bram Stoker in 1897.">bibliothecula</h1>
    <details class="touch"><summary><h1 class="touch" title="the colorscheme of the page is inspired by the cover of the first edition of Dracula by Bram Stoker in 1897.">bibliothecula</h1></summary></details>
    <picture>
      <source srcset="./img/logo.webp" type="image/webp">
      <img class="logo" src="../img/logo.png" alt="bibliothecula logo" title="Illustration of bat from De arte venandi cum avibus by HRE Frederick II (circa 1240s). It's a visual pun because it looks like an open book viewed from above, and also bibliothecula shares a suffix with the word Dracula.">
    </picture>
  </header>
  <blockquote>
    <p class="def"><em>bibliothÄ“cula</em> f (genitive <span class="nobr"><em>bibliothÄ“culae</em>&#8202;);</span> first declension (Late Latin)</p>
    <ul>
      <li>small library</li>
      <li>small collection of books</li>
      <li>document organizer with tags and full-text-search, in a simple and clean <code>sqlite3</code> schema</li>
    </ul>
  </blockquote>
  <div>
    <h2>why</h2>
    <ul>
      <li>Organise journal articles for bibliographies</li>
      <li>Organise e-books</li>
      <li>Store plain text notes with automatic full-text search and back-reference indexing (i.e. a <a href="https://en.wikipedia.org/wiki/Zettelkasten" rel="nofollow">Zettelkasten</a>) </li>
    </ul>
  </div>
  <div>
    <h2>where</h2>
    <div class="repo">
      <strong><a rel="me" href="https://github.com/epilys/bibliothecula">https://github.com/epilys/bibliothecula</a></strong> <a rel="external nofollow" href="https://www.gnu.org/licenses/gpl-3.0-standalone.html"><small><abbr title="The GNU General Public License v3.0">GPLv3</abbr></small></a>
    </div>
  </div>
  <div>
    <h2>what <a href="https://github.com/epilys/bibliothecula/tree/main/docs">ðŸ”—</a></h2>
    <pre>
<span class="pl-k">CREATE</span> <span class="pl-k">TABLE</span> <span class="pl-en">IF</span> NOT EXISTS <span class="pl-s"><span class="pl-pds">"</span>Documents<span class="pl-pds">"</span></span> (
        <span class="pl-s"><span class="pl-pds">"</span>uuid<span class="pl-pds">"</span></span> <span class="pl-k">CHAR</span>(<span class="pl-c1">32</span>) <span class="pl-k">NOT NULL</span> <span class="pl-k">PRIMARY KEY</span>,
        <span class="pl-s"><span class="pl-pds">"</span>title<span class="pl-pds">"</span></span> <span class="pl-k">TEXT</span> <span class="pl-k">NOT NULL</span>,
        <span class="pl-s"><span class="pl-pds">"</span>title_suffix<span class="pl-pds">"</span></span> <span class="pl-k">TEXT</span>,
        <span class="pl-s"><span class="pl-pds">"</span>created<span class="pl-pds">"</span></span> datetime <span class="pl-k">NOT NULL</span> DEFAULT (strftime (<span class="pl-s"><span class="pl-pds">'</span>%Y-%m-%d %H:%M:%f<span class="pl-pds">'</span></span>,
                <span class="pl-s"><span class="pl-pds">'</span>now<span class="pl-pds">'</span></span>)),
        <span class="pl-s"><span class="pl-pds">"</span>last_modified<span class="pl-pds">"</span></span> datetime <span class="pl-k">NOT NULL</span> DEFAULT (strftime (<span class="pl-s"><span class="pl-pds">'</span>%Y-%m-%d %H:%M:%f<span class="pl-pds">'</span></span>,
                <span class="pl-s"><span class="pl-pds">'</span>now<span class="pl-pds">'</span></span>))
);
<span class="pl-k">CREATE</span> <span class="pl-k">TABLE</span> <span class="pl-en">IF</span> NOT EXISTS <span class="pl-s"><span class="pl-pds">"</span>TextMetadata<span class="pl-pds">"</span></span> (
        <span class="pl-s"><span class="pl-pds">"</span>uuid<span class="pl-pds">"</span></span> <span class="pl-k">char</span>(<span class="pl-c1">32</span>) <span class="pl-k">NOT NULL</span> <span class="pl-k">PRIMARY KEY</span>,
        <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span> <span class="pl-k">text</span> <span class="pl-k">NULL</span>,
        <span class="pl-s"><span class="pl-pds">"</span>data<span class="pl-pds">"</span></span> <span class="pl-k">text</span> <span class="pl-k">NOT NULL</span>,
        <span class="pl-s"><span class="pl-pds">"</span>created<span class="pl-pds">"</span></span> datetime <span class="pl-k">NOT NULL</span>,
        <span class="pl-s"><span class="pl-pds">"</span>last_modified<span class="pl-pds">"</span></span> datetime <span class="pl-k">NOT NULL</span>
);
<span class="pl-k">CREATE</span> <span class="pl-k">TABLE</span> <span class="pl-en">IF</span> NOT EXISTS <span class="pl-s"><span class="pl-pds">"</span>DocumentHasTextMetadata<span class="pl-pds">"</span></span> (
        <span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span> <span class="pl-k">INTEGER</span> <span class="pl-k">NOT NULL</span> <span class="pl-k">PRIMARY KEY</span> AUTOINCREMENT,
        <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span> <span class="pl-k">TEXT</span> <span class="pl-k">NOT NULL</span>,
        <span class="pl-s"><span class="pl-pds">"</span>document_uuid<span class="pl-pds">"</span></span> <span class="pl-k">char</span>(<span class="pl-c1">32</span>) <span class="pl-k">NOT NULL</span> <span class="pl-k">REFERENCES</span> <span class="pl-s"><span class="pl-pds">"</span>Documents<span class="pl-pds">"</span></span> (<span class="pl-s"><span class="pl-pds">"</span>uuid<span class="pl-pds">"</span></span>) DEFERRABLE INITIALLY DEFERRED,
        <span class="pl-s"><span class="pl-pds">"</span>metadata_uuid<span class="pl-pds">"</span></span> <span class="pl-k">char</span>(<span class="pl-c1">32</span>) <span class="pl-k">NOT NULL</span> <span class="pl-k">REFERENCES</span> <span class="pl-s"><span class="pl-pds">"</span>TextMetadata<span class="pl-pds">"</span></span> (<span class="pl-s"><span class="pl-pds">"</span>uuid<span class="pl-pds">"</span></span>) DEFERRABLE INITIALLY DEFERRED,
        <span class="pl-s"><span class="pl-pds">"</span>created<span class="pl-pds">"</span></span> datetime <span class="pl-k">NOT NULL</span> DEFAULT (strftime (<span class="pl-s"><span class="pl-pds">'</span>%Y-%m-%d %H:%M:%f<span class="pl-pds">'</span></span>,
                <span class="pl-s"><span class="pl-pds">'</span>now<span class="pl-pds">'</span></span>)),
        <span class="pl-s"><span class="pl-pds">"</span>last_modified<span class="pl-pds">"</span></span> datetime <span class="pl-k">NOT NULL</span> DEFAULT (strftime (<span class="pl-s"><span class="pl-pds">'</span>%Y-%m-%d %H:%M:%f<span class="pl-pds">'</span></span>,
                <span class="pl-s"><span class="pl-pds">'</span>now<span class="pl-pds">'</span></span>))
);
<span class="pl-k">CREATE</span> <span class="pl-k">TABLE</span> <span class="pl-en">IF</span> NOT EXISTS <span class="pl-s"><span class="pl-pds">"</span>BinaryMetadata<span class="pl-pds">"</span></span> (
        <span class="pl-s"><span class="pl-pds">"</span>uuid<span class="pl-pds">"</span></span> <span class="pl-k">char</span>(<span class="pl-c1">32</span>) <span class="pl-k">NOT NULL</span> <span class="pl-k">PRIMARY KEY</span>,
        <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span> <span class="pl-k">text</span> <span class="pl-k">NULL</span>,
        <span class="pl-s"><span class="pl-pds">"</span>data<span class="pl-pds">"</span></span> BLOB <span class="pl-k">NOT NULL</span>,
        <span class="pl-s"><span class="pl-pds">"</span>created<span class="pl-pds">"</span></span> datetime <span class="pl-k">NOT NULL</span>,
        <span class="pl-s"><span class="pl-pds">"</span>last_modified<span class="pl-pds">"</span></span> datetime <span class="pl-k">NOT NULL</span>
);
<span class="pl-k">CREATE</span> <span class="pl-k">TABLE</span> <span class="pl-en">IF</span> NOT EXISTS <span class="pl-s"><span class="pl-pds">"</span>DocumentHasBinaryMetadata<span class="pl-pds">"</span></span> (
        <span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span> <span class="pl-k">INTEGER</span> <span class="pl-k">NOT NULL</span> <span class="pl-k">PRIMARY KEY</span> AUTOINCREMENT,
        <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span> <span class="pl-k">TEXT</span> <span class="pl-k">NOT NULL</span>,
        <span class="pl-s"><span class="pl-pds">"</span>document_uuid<span class="pl-pds">"</span></span> <span class="pl-k">char</span>(<span class="pl-c1">32</span>) <span class="pl-k">NOT NULL</span> <span class="pl-k">REFERENCES</span> <span class="pl-s"><span class="pl-pds">"</span>Documents<span class="pl-pds">"</span></span> (<span class="pl-s"><span class="pl-pds">"</span>uuid<span class="pl-pds">"</span></span>) DEFERRABLE INITIALLY DEFERRED,
        <span class="pl-s"><span class="pl-pds">"</span>metadata_uuid<span class="pl-pds">"</span></span> <span class="pl-k">char</span>(<span class="pl-c1">32</span>) <span class="pl-k">NOT NULL</span> <span class="pl-k">REFERENCES</span> <span class="pl-s"><span class="pl-pds">"</span>BinaryMetadata<span class="pl-pds">"</span></span> (<span class="pl-s"><span class="pl-pds">"</span>uuid<span class="pl-pds">"</span></span>) DEFERRABLE INITIALLY DEFERRED,
        <span class="pl-s"><span class="pl-pds">"</span>created<span class="pl-pds">"</span></span> datetime <span class="pl-k">NOT NULL</span> DEFAULT (strftime (<span class="pl-s"><span class="pl-pds">'</span>%Y-%m-%d %H:%M:%f<span class="pl-pds">'</span></span>,
                <span class="pl-s"><span class="pl-pds">'</span>now<span class="pl-pds">'</span></span>)),
        <span class="pl-s"><span class="pl-pds">"</span>last_modified<span class="pl-pds">"</span></span> datetime <span class="pl-k">NOT NULL</span> DEFAULT (strftime (<span class="pl-s"><span class="pl-pds">'</span>%Y-%m-%d %H:%M:%f<span class="pl-pds">'</span></span>,
                <span class="pl-s"><span class="pl-pds">'</span>now<span class="pl-pds">'</span></span>))
);
<span class="pl-c"><span class="pl-c">/*</span> document_title_authors_text_view_fts(title,authors,full_text,uuid) <span class="pl-c">*/</span></span>
CREATE VIRTUAL TABLE document_title_authors_text_view_fts
USING fts5 (
    title,
    authors,
    full_text,
    uuid UNINDEXED)
;
<span class="pl-c"><span class="pl-c">/*</span> document_title_authors(rowid,title,authors) <span class="pl-c">*/</span></span>
<span class="pl-k">CREATE</span> <span class="pl-k">VIEW</span> <span class="pl-en">document_title_authors</span> (
    rowid,
    title,
    authors) <span class="pl-k">AS</span>
<span class="pl-k">SELECT</span>
    <span class="pl-k">*</span>
<span class="pl-k">FROM</span>
    document_title_without_authors
<span class="pl-k">UNION</span>
<span class="pl-k">SELECT</span>
    <span class="pl-k">*</span>
<span class="pl-k">FROM</span>
    document_title_with_authors
;
<span class="pl-c"><span class="pl-c">/*</span> document_title_authors_text_view(rowid,title,authors,full_text) <span class="pl-c">*/</span></span>
<span class="pl-k">CREATE</span> <span class="pl-k">VIEW</span> <span class="pl-en">document_title_authors_text_view</span> (
    rowid,
    title,
    authors,
    full_text) <span class="pl-k">AS</span>
<span class="pl-k">SELECT</span>
    <span class="pl-c1">d</span>.<span class="pl-c1">uuid</span> <span class="pl-k">AS</span> uuid,
    <span class="pl-c1">d</span>.<span class="pl-c1">title</span> <span class="pl-k">AS</span> title,
    GROUP_CONCAT (
        <span class="pl-c1">authors</span>.<span class="pl-c1">author</span>) <span class="pl-k">AS</span> authors,
    <span class="pl-c1">bm</span>.<span class="pl-c1">data</span> <span class="pl-k">AS</span> full_text
<span class="pl-k">FROM</span>
    Documents <span class="pl-k">AS</span> d,
    DocumentHasBinaryMetadata <span class="pl-k">AS</span> dhbm,
    BinaryMetadata <span class="pl-k">AS</span> bm,
    (
        <span class="pl-k">SELECT</span>
            <span class="pl-c1">d</span>.<span class="pl-c1">uuid</span> <span class="pl-k">AS</span> uuid,
            <span class="pl-c1">tm</span>.<span class="pl-c1">data</span> <span class="pl-k">AS</span> author
        <span class="pl-k">FROM</span>
            Documents <span class="pl-k">AS</span> d,
            TextMetadata <span class="pl-k">AS</span> tm,
            DocumentHasTextMetadata <span class="pl-k">AS</span> dhtm
        <span class="pl-k">WHERE</span>
            <span class="pl-c1">dhtm</span>.<span class="pl-c1">document_uuid</span> <span class="pl-k">=</span> <span class="pl-c1">d</span>.<span class="pl-c1">uuid</span>
            <span class="pl-k">AND</span> <span class="pl-c1">dhtm</span>.<span class="pl-c1">metadata_uuid</span> <span class="pl-k">=</span> <span class="pl-c1">tm</span>.<span class="pl-c1">uuid</span>
            <span class="pl-k">AND</span> <span class="pl-c1">tm</span>.<span class="pl-c1">name</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>author<span class="pl-pds">'</span></span>) <span class="pl-k">AS</span> authors
<span class="pl-k">WHERE</span>
    <span class="pl-c1">bm</span>.<span class="pl-c1">uuid</span> <span class="pl-k">=</span> <span class="pl-c1">dhbm</span>.<span class="pl-c1">metadata_uuid</span>
    <span class="pl-k">AND</span> <span class="pl-c1">d</span>.<span class="pl-c1">uuid</span> <span class="pl-k">=</span> <span class="pl-c1">dhbm</span>.<span class="pl-c1">document_uuid</span>
    <span class="pl-k">AND</span> <span class="pl-c1">bm</span>.<span class="pl-c1">name</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>full-text<span class="pl-pds">'</span></span>
    <span class="pl-k">AND</span> <span class="pl-c1">authors</span>.<span class="pl-c1">uuid</span> <span class="pl-k">=</span> <span class="pl-c1">d</span>.<span class="pl-c1">uuid</span>
<span class="pl-k">GROUP BY</span>
    <span class="pl-c1">d</span>.<span class="pl-c1">uuid</span>
;
<span class="pl-c"><span class="pl-c">/*</span> document_title_without_authors(rowid,title,authors) <span class="pl-c">*/</span></span>
<span class="pl-k">CREATE</span> <span class="pl-k">VIEW</span> <span class="pl-en">document_title_without_authors</span> (
    rowid,
    title,
    authors) <span class="pl-k">AS</span>
<span class="pl-k">SELECT</span>
    <span class="pl-c1">d</span>.<span class="pl-c1">uuid</span> <span class="pl-k">AS</span> uuid,
    <span class="pl-c1">d</span>.<span class="pl-c1">title</span> <span class="pl-k">AS</span> title,
    <span class="pl-k">NULL</span> <span class="pl-k">AS</span> authors
<span class="pl-k">FROM</span>
    Documents <span class="pl-k">AS</span> d
<span class="pl-k">WHERE</span>
    NOT EXISTS (
        <span class="pl-k">SELECT</span>
            <span class="pl-k">*</span>
        <span class="pl-k">FROM</span>
            TextMetadata <span class="pl-k">AS</span> t,
            DocumentHasTextMetadata <span class="pl-k">AS</span> dt
        <span class="pl-k">WHERE</span>
            <span class="pl-c1">t</span>.<span class="pl-c1">name</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>author<span class="pl-pds">'</span></span>
            <span class="pl-k">AND</span> <span class="pl-c1">t</span>.<span class="pl-c1">uuid</span> <span class="pl-k">=</span> <span class="pl-c1">dt</span>.<span class="pl-c1">metadata_uuid</span>
            <span class="pl-k">AND</span> <span class="pl-c1">dt</span>.<span class="pl-c1">document_uuid</span> <span class="pl-k">=</span> <span class="pl-c1">d</span>.<span class="pl-c1">uuid</span>)
;
<span class="pl-c"><span class="pl-c">/*</span> document_title_with_authors(rowid,title,authors) <span class="pl-c">*/</span></span>
<span class="pl-k">CREATE</span> <span class="pl-k">VIEW</span> <span class="pl-en">document_title_with_authors</span> (
    rowid,
    title,
    authors) <span class="pl-k">AS</span>
<span class="pl-k">SELECT</span>
    <span class="pl-c1">d</span>.<span class="pl-c1">uuid</span> <span class="pl-k">AS</span> uuid,
    <span class="pl-c1">d</span>.<span class="pl-c1">title</span> <span class="pl-k">AS</span> title,
    GROUP_CONCAT (
        <span class="pl-c1">authors</span>.<span class="pl-c1">author</span>) <span class="pl-k">AS</span> authors
<span class="pl-k">FROM</span>
    Documents <span class="pl-k">AS</span> d,
    (
        <span class="pl-k">SELECT</span>
            <span class="pl-c1">d</span>.<span class="pl-c1">uuid</span> <span class="pl-k">AS</span> uuid,
            <span class="pl-c1">tm</span>.<span class="pl-c1">data</span> <span class="pl-k">AS</span> author
        <span class="pl-k">FROM</span>
            Documents <span class="pl-k">AS</span> d,
            TextMetadata <span class="pl-k">AS</span> tm,
            DocumentHasTextMetadata <span class="pl-k">AS</span> dhtm
        <span class="pl-k">WHERE</span>
            <span class="pl-c1">dhtm</span>.<span class="pl-c1">document_uuid</span> <span class="pl-k">=</span> <span class="pl-c1">d</span>.<span class="pl-c1">uuid</span>
            <span class="pl-k">AND</span> <span class="pl-c1">dhtm</span>.<span class="pl-c1">metadata_uuid</span> <span class="pl-k">=</span> <span class="pl-c1">tm</span>.<span class="pl-c1">uuid</span>
            <span class="pl-k">AND</span> <span class="pl-c1">tm</span>.<span class="pl-c1">name</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>author<span class="pl-pds">'</span></span>) <span class="pl-k">AS</span> authors
<span class="pl-k">WHERE</span>
    <span class="pl-c1">authors</span>.<span class="pl-c1">uuid</span> <span class="pl-k">=</span> <span class="pl-c1">d</span>.<span class="pl-c1">uuid</span>
<span class="pl-k">GROUP BY</span>
    <span class="pl-c1">d</span>.<span class="pl-c1">uuid</span>
;
<span class="pl-k">CREATE</span> <span class="pl-k">TRIGGER</span> <span class="pl-en">delete_full_text_trigger</span> AFTER <span class="pl-k">DELETE</span> <span class="pl-k">ON</span> DocumentHasBinaryMetadata
WHEN EXISTS (
        <span class="pl-k">SELECT</span>
            <span class="pl-k">*</span>
        <span class="pl-k">FROM</span>
            BinaryMetadata <span class="pl-k">AS</span> bm
        <span class="pl-k">WHERE</span>
            <span class="pl-c1">OLD</span>.<span class="pl-c1">metadata_uuid</span> <span class="pl-k">=</span> <span class="pl-c1">bm</span>.<span class="pl-c1">uuid</span>
            <span class="pl-k">AND</span> <span class="pl-c1">bm</span>.<span class="pl-c1">name</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>full-text<span class="pl-pds">'</span></span>)
<span class="pl-k">BEGIN</span>
    <span class="pl-k">DELETE</span>
<span class="pl-k">FROM</span>
    document_title_authors_text_view_fts
<span class="pl-k">WHERE</span>
    uuid <span class="pl-k">=</span> <span class="pl-c1">OLD</span>.<span class="pl-c1">document_uuid</span>;
END;
<span class="pl-k">CREATE</span> <span class="pl-k">TRIGGER</span> <span class="pl-en">insert_full_text_trigger</span> AFTER INSERT <span class="pl-k">ON</span> DocumentHasBinaryMetadata
WHEN EXISTS (
        <span class="pl-k">SELECT</span>
            <span class="pl-k">*</span>
        <span class="pl-k">FROM</span>
            BinaryMetadata <span class="pl-k">AS</span> bm
        <span class="pl-k">WHERE</span>
            <span class="pl-c1">NEW</span>.<span class="pl-c1">metadata_uuid</span> <span class="pl-k">=</span> <span class="pl-c1">bm</span>.<span class="pl-c1">uuid</span>
            <span class="pl-k">AND</span> <span class="pl-c1">bm</span>.<span class="pl-c1">name</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>full-text<span class="pl-pds">'</span></span>)
<span class="pl-k">BEGIN</span>
    <span class="pl-k">INSERT INTO</span> document_title_authors_text_view_fts (
        uuid, title, authors, full_text)
<span class="pl-k">SELECT</span>
    <span class="pl-c1">d</span>.<span class="pl-c1">rowid</span> <span class="pl-k">AS</span> rowid, <span class="pl-c1">d</span>.<span class="pl-c1">title</span> <span class="pl-k">AS</span> title, <span class="pl-c1">d</span>.<span class="pl-c1">authors</span> <span class="pl-k">AS</span> authors, <span class="pl-c1">bm</span>.<span class="pl-c1">data</span> <span class="pl-k">AS</span> full_text
<span class="pl-k">FROM</span>
    document_title_authors <span class="pl-k">AS</span> d
    <span class="pl-k">JOIN</span> BinaryMetadata <span class="pl-k">AS</span> bm <span class="pl-k">ON</span> <span class="pl-c1">bm</span>.<span class="pl-c1">uuid</span> <span class="pl-k">=</span> <span class="pl-c1">NEW</span>.<span class="pl-c1">metadata_uuid</span>
<span class="pl-k">WHERE</span>
    <span class="pl-c1">d</span>.<span class="pl-c1">rowid</span> <span class="pl-k">=</span> <span class="pl-c1">NEW</span>.<span class="pl-c1">document_uuid</span>
    <span class="pl-k">AND</span> <span class="pl-c1">bm</span>.<span class="pl-c1">name</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>full-text<span class="pl-pds">'</span></span>
    <span class="pl-k">AND</span> <span class="pl-c1">bm</span>.<span class="pl-c1">uuid</span> <span class="pl-k">=</span> <span class="pl-c1">NEW</span>.<span class="pl-c1">metadata_uuid</span>;
END;
<span class="pl-c"><span class="pl-c">/*</span> uuidtok(input,token,start,"end",position) <span class="pl-c">*/</span></span>
CREATE VIRTUAL TABLE uuidtok
USING fts3tokenize (
    <span class="pl-s"><span class="pl-pds">'</span>unicode61<span class="pl-pds">'</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>tokenchars=-1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ<span class="pl-pds">"</span></span>,
    <span class="pl-s"><span class="pl-pds">"</span>separators= <span class="pl-pds">"</span></span>)
;
</pre>
  </div>
  <div>
    <h2>stuff</h2>
    <h3>fuse filesystem <a href="https://github.com/epilys/bibliothecula/tree/main/biblfs">ðŸ”—</a></h3>
    <pre>$ <span class="pl-s1">ls <span class="pl-k">~</span>/Documents/biblfs <span class="pl-k">|</span> head</span>
<span class="pl-c1">total 393K</span>
<span class="pl-c1">drwxr-xr-x  2 epilys epilys     0 Jan  1  1970 ./</span>
<span class="pl-c1">drwxrwxrwt 98 root   root    120K Jun 14 19:27 ../</span>
<span class="pl-c1">-rw-r--r--  1 epilys epilys  589K Jun 14 00:35 a-a-milne_the-red-house-mystery.epub</span>
<span class="pl-c1">-rw-r--r--  1 epilys epilys  450K Jun 14 00:58 aesop_fables_v-s-vernon-jones.epub</span>
<span class="pl-c1">-rw-r--r--  1 epilys epilys  601K Jun 14 00:58 agatha-christie_poirot-investigates.epub</span>
<span class="pl-c1">-rw-r--r--  1 epilys epilys  594K Jun 14 00:58 agatha-christie_the-man-in-the-brown-suit.epub</span>
<span class="pl-c1">-rw-r--r--  1 epilys epilys  523K Jun 14 00:40 agatha-christie_the-murder-on-the-links.epub</span>
<span class="pl-c1">-rw-r--r--  1 epilys epilys  780K Jun 14 00:37 agatha-christie_the-mysterious-affair-at-styles.epub</span>
<span class="pl-c1">-rw-r--r--  1 epilys epilys  651K Jun 14 00:58 agatha-christie_the-secret-adversary.epub</span>
$ <span class="pl-s1">ls <span class="pl-s"><span class="pl-pds">"</span>~/Documents/biblfs/tags/Arthurian romances<span class="pl-pds">"</span></span></span>
<span class="pl-c1">total 1.5K</span>
<span class="pl-c1">drwxr-xr-x 2 epilys epilys    0 Jan  1  1970 ./</span>
<span class="pl-c1">drwxr-xr-x 2 epilys epilys    0 Jan  1  1970 ../</span>
<span class="pl-c1">-rw-r--r-- 1 epilys epilys 817K Jun 14 00:35 alfred-lord-tennyson_idylls-of-the-king.epub</span>
<span class="pl-c1">-rw-r--r-- 1 epilys epilys 979K Jun 14 00:45 mark-twain_a-connecticut-yankee-in-king-arthurs-court.epub</span>
<span class="pl-c1">-rw-r--r-- 1 epilys epilys 1.6M Jun 14 00:39 thomas-malory_le-morte-darthur.epub</span>
$ <span class="pl-s1">ls <span class="pl-k">~</span>/Documents/biblfs/query/journal <span class="pl-k">|</span> head</span>
<span class="pl-c1">total 73K</span>
<span class="pl-c1">drwxr-xr-x 2 epilys epilys     0 Jan  1  1970 ./</span>
<span class="pl-c1">drwxr-xr-x 2 epilys epilys     0 Jan  1  1970 ../</span>
<span class="pl-c1">-rw-r--r-- 1 epilys epilys  1.1M Jun 14 00:40 alexander-hamilton_john-jay_james-madison_the-federalist-papers.epub</span>
<span class="pl-c1">-rw-r--r-- 1 epilys epilys  679K Jun 14 00:35 alexander-pushkin_eugene-onegin_henry-spalding.epub</span>
<span class="pl-c1">-rw-r--r-- 1 epilys epilys  1.7M Jun 14 00:35 alexandre-dumas_the-count-of-monte-cristo_chapman-and-hall.epub</span>
<span class="pl-c1">-rw-r--r-- 1 epilys epilys  1.1M Jun 14 00:35 alexandre-dumas_the-three-musketeers_william-robson.epub</span>
<span class="pl-c1">-rw-r--r-- 1 epilys epilys  572K Jun 14 00:35 ambrose-bierce_the-devils-dictionary.epub</span>
<span class="pl-c1">-rw-r--r-- 1 epilys epilys  664K Jun 14 00:35 anatole-france_penguin-island_a-w-evans.epub</span>
<span class="pl-c1">-rw-r--r-- 1 epilys epilys  1.1M Jun 14 00:35 anthony-trollope_the-way-we-live-now.epub</span></pre>
  </div>
  <div>
    <h3 id="web-gui">web gui <a href="https://github.com/epilys/bibliothecula/tree/main/biblfs">ðŸ”—</a></h3>
    <p><a href="./web-demo/index.html">see non-interactive, static demo here ðŸ”—</a></p>
    <div class="screenshots">
      <figure>
        <a href="#grid-zoom"><img src="./img/screenshot-grid-view.webp" alt="grid view" decoding="async" loading="lazy"></a>
        <figcaption>
          <a href="#grid-zoom">grid view</a>
        </figcaption>
      </figure>
      <figure>
        <a href="#full-text-grid-zoom"><img src="./img/screenshot-full-text-grid-property.webp" alt="full-text search on grid view" decoding="async" loading="lazy"></a>
        <figcaption>
          <a href="#full-text-grid-zoom">full-text search on grid view</a>
        </figcaption>
      </figure>
      <figure>
        <a href="#full-text-table-zoom"><img src="./img/screenshot-full-text-table-property.webp" alt="and on table view" decoding="async" loading="lazy"></a>
        <figcaption>
          <a href="#full-text-table-zoom">and on table view</a>
        </figcaption>
      </figure>
      <figure>
        <a href="#database-zoom"><img src="./img/screenshot-database-view.webp" alt="database view" decoding="async" loading="lazy"></a>
        <figcaption>
          <a href="#database-zoom">database view</a>
        </figcaption>
      </figure>
      <figure id="d3">
        <a href="#d3-zoom"><img src="./img/screenshot-d3-tag-graph.webp" alt="d3.js tag visualization" decoding="async" loading="lazy"></a>
        <figcaption>
          <a href="#d3-zoom"><code>d3.js</code> tag visualization</a>
        </figcaption>
      </figure>
      <figure>
        <a href="#document-zoom"><img src="./img/screenshot-document-view.webp" alt="document view" decoding="async" loading="lazy"></a>
        <figcaption>
          <a href="#document-zoom">document view</a>
        </figcaption>
      </figure>
    </div>
  </div>
  <footer>
    <a rel="me" style="display: none;" href="https://chaos.social/@epilys"></a> <a rel="me" href="https://github.com/epilys/bibliothecula">https://github.com/epilys/bibliothecula</a> <a rel="external nofollow" href="https://www.gnu.org/licenses/gpl-3.0-standalone.html"><small><abbr class="gpl" title="The GNU General Public License v3.0">GPLv3</abbr></small></a>
  </footer>
</body>
</html>
